import"./style-S5nVlci7.js";const u=async(e,o={})=>{let n;try{const t=await fetch(e,o);if(!t.ok)throw new Error(`HTTP ${t.status} - ${t.statusText}`);n=await t.json()}catch(t){console.error("fetchData() error",t),n={}}return n},m=document.querySelector(".logout a");m.addEventListener("click",()=>{localStorage.removeItem("token"),window.location.href="index.html"});const h=document.querySelector(".get_users");h.addEventListener("click",d);async function d(){console.log("Getting all users");const e="/api/users",n={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};u(e,n).then(t=>{f(t)})}function f(e){console.log(e);const o=document.querySelector(".tbody");o.innerHTML="",e.forEach(n=>{const t=document.createElement("tr"),r=document.createElement("td");r.textContent=n.username;const s=document.createElement("td"),c=document.createElement("button");c.textContent="Info",c.className="check",c.setAttribute("data-id",n.user_id),c.addEventListener("click",()=>p(n.user_id)),s.appendChild(c);const a=document.createElement("td"),l=document.createElement("button");l.textContent="Delete",l.className="del",l.setAttribute("data-id",n.user_id),l.addEventListener("click",i),a.appendChild(l),t.appendChild(r),t.appendChild(s),t.appendChild(a),o.appendChild(t)})}async function E(e){try{const o=localStorage.getItem("token");if(!o)throw new Error("User token not found. Please log in.");const n=`/api/users/${e}`,t={method:"GET",headers:{Authorization:"Bearer "+o}},r=await fetch(n,t);if(!r.ok)throw new Error("Failed to fetch user information.");const s=await r.json();return console.log("User Information:",s),g(s),s}catch(o){return console.error("Error:",o),alert("Failed to fetch user information. Error details can be found in the console."),null}}function g(e){const o=document.getElementById("userInfo"),n=document.getElementById("id"),t=document.getElementById("username"),r=document.getElementById("email"),s=document.getElementById("level"),c=document.getElementById("createdAt");n.innerHTML=`${e.user_id}`,t.innerHTML=`${e.username}`,r.innerHTML=`${e.email}`,s.innerHTML=`${e.user_level}`,c.innerHTML=`${e.created_at}`,o.style.display="block"}function p(e){E(e)}function i(){try{const e=localStorage.getItem("token");if(!e)throw new Error("User token not found. Please log in.");const o=`/api/users/${id}`,n={method:"DELETE",headers:{Authorization:"Bearer "+e}};confirm(`Are you sure you want to delete user ID: ${id} `)&&fetch(o,n).then(r=>{if(r.ok)console.log("User deleted successfully"),d();else throw new Error("Failed to delete user")}).catch(r=>{console.error("Error deleting user: ",r)})}catch(e){console.error("Error deleting user: ",e)}}i(userId);

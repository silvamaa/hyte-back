import"./style-S5nVlci7.js";const i=async(e,n={})=>{let o;try{const t=await fetch(e,n);if(!t.ok)throw new Error(`HTTP ${t.status} - ${t.statusText}`);o=await t.json()}catch(t){console.error("fetchData() error",t),o={}}return o},u=document.querySelector(".logout a");u.addEventListener("click",()=>{localStorage.removeItem("token"),window.location.href="index.html"});const m=document.querySelector(".get_users");m.addEventListener("click",d);async function d(){console.log("Getting all users");const e="/api/users",o={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};i(e,o).then(t=>{h(t)})}function h(e){console.log(e);const n=document.querySelector(".tbody");n.innerHTML="",e.forEach(o=>{const t=document.createElement("tr"),c=document.createElement("td");c.textContent=o.username;const r=document.createElement("td"),s=document.createElement("button");s.textContent="Info",s.className="check",s.setAttribute("data-id",o.user_id),s.addEventListener("click",()=>g(o.user_id)),r.appendChild(s);const a=document.createElement("td"),l=document.createElement("button");l.textContent="Delete",l.className="del",l.setAttribute("data-id",o.user_id),l.addEventListener("click",p),a.appendChild(l),t.appendChild(c),t.appendChild(r),t.appendChild(a),n.appendChild(t)})}async function f(e){try{const n=localStorage.getItem("token");if(!n)throw new Error("User token not found. Please log in.");const o=`/api/users/${e}`,t={method:"GET",headers:{Authorization:"Bearer "+n}},c=await fetch(o,t);if(!c.ok)throw new Error("Failed to fetch user information.");const r=await c.json();return console.log("User Information:",r),E(r),r}catch(n){return console.error("Error:",n),alert("Failed to fetch user information. Error details can be found in the console."),null}}function E(e){const n=document.getElementById("userInfo"),o=document.getElementById("id"),t=document.getElementById("username"),c=document.getElementById("email"),r=document.getElementById("level"),s=document.getElementById("createdAt");o.innerHTML=`${e.user_id}`,t.innerHTML=`${e.username}`,c.innerHTML=`${e.email}`,r.innerHTML=`${e.user_level}`,s.innerHTML=`${e.created_at}`,n.style.display="block"}function g(e){f(e)}function p(e){try{const n=localStorage.getItem("token");if(!n)throw new Error("User token not found. Please log in.");const o=`/api/users/${e}`,t={method:"DELETE",headers:{Authorization:"Bearer "+n}};confirm(`Are you sure you want to delete user ID: ${e} `)&&fetch(o,t).then(r=>{if(r.ok)console.log("User deleted successfully"),d();else throw new Error("Failed to delete user")}).catch(r=>{console.error("Error deleting user: ",r)})}catch(n){console.error("Error deleting user: ",n)}}
